---
title: Pinia ê³µì‹ë¬¸ì„œ ë³´ê³  ì ìš©í•˜ê¸°
date: 2023-04-26
categories: [Vue]
tags: [pinia, vue3] # TAG names should always be lowercase
pin: true
---

<!-- ### **ëª©ì°¨** 
<span style="font-size: 12px; color: gray">
ì˜¤ë¥˜ ë°œìƒ<br>
hi
</span>
[ì˜¤ë¥˜ ë°œìƒ ğŸ’¥](###ì˜¤ë¥˜-ë°œìƒ) -->


***
# What is Pinia?
ì°¸ê³ : ê³µì‹ë¬¸ì„œ  
[https://pinia.vuejs.org/introduction.html#introduction](https://pinia.vuejs.org/introduction.html#introduction)

<br>

## Introduction
PiniaëŠ” 2019ë…„ 11ì›”ê²½ì— Composition APIë¥¼ ì‚¬ìš©í•˜ì—¬ Vueì˜ Storeê°€ ì–´ë–»ê²Œ ë””ìì¸ ë  ìˆ˜ ìˆëŠ” ì§€ë¥¼ ì¬ì„¤ê³„í•˜ëŠ” ì‹¤í—˜ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì´í›„ ì´ˆê¸° ì›ì¹™ì€ ê·¸ëŒ€ë¡œ ìœ ì§€ë˜ì—ˆì§€ë§Œ, PiniaëŠ” Vue 2ì™€ Vue 3 ëª¨ë‘ì—ì„œ ì‘ë™í•˜ë©° ê¼­ Composition APIë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

<br>

## í”¼ë‹ˆì•„ ì œê³µ ê¸°ëŠ¥
> ğŸ’¡ Note:  
> ê°œë°œì ë„êµ¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  
> íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

- Devtools support
    - A timeline to track actions, mutations
    - Stores appear in components where they are used
    - Time travel and easier debugging
- Hot module replacement
    - Modify your stores without reloading your page
    - Keep any existing state while developing
- Plugins: extend Pinia features with plugins
- Proper TypeScript support orÂ **autocompletion**Â for JS users
- Server Side Rendering Support

<br>

## WhyÂ *Pinia*
PiniaëŠ” íŒŒì¸ì• í”Œì˜ ìŠ¤í˜ì¸ì–´ì¸ piÃ±a ì™€ ë¹„ìŠ·í•œ ì´ë¦„ì„ ê°€ì§„ë‹¤. íŒŒì¸ì• í”Œì€ ì‹¤ì œë¡œ ì—¬ëŸ¬ ê°œì˜ ê°œë³„ ê½ƒì´ ê²°í•©í•˜ì—¬ ë§Œë“œëŠ” ê³¼ì¼ì´ë‹¤. Piniaê°€ ì œê³µí•˜ëŠ” Storeì™€ ìœ ì‚¬í•œ ì ìœ¼ë¡œ ê°ê° ê°œë³„ì ìœ¼ë¡œ íƒœì–´ë‚˜ì§€ë§Œ(ìƒì„±ë˜ì§€ë§Œ) ê²°êµ­ì€ ëª¨ë‘ ì—°ê²°ë˜ì–´ ìˆë‹¤ëŠ” ì ì´ ë¹„ìŠ·í•˜ë‹¤.

<br>

## Comparison with Vuex 3.x/4.x[](https://pinia.vuejs.org/introduction.html#comparison-with-vuex-3-x-4-x)
> ğŸ’¡ Note:  
> ë” ì´ìƒ mutations ì€ ì•ˆì“´ë‹¤.  
> íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì“°ê¸°ìœ„í•´ ë³µì¡í•œ wrapperë¥¼ ìƒì„±í•  í•„ìš”ê°€ ì—†ë‹¤.  

- No more magic strings to inject, import the functions, call them, enjoy autocompletion!
- No need to dynamically add stores, they are all dynamic by default and you won't even notice. Note you can still manually use a store to register it whenever you want but because it is automatic you don't need to worry about it.
- No more nested structuring ofÂ *modules*. You can still nest stores implicitly by importing andÂ *using*Â a store inside another but Pinia offers a flat structuring by design while still enabling ways of cross composition among stores.Â **You can even have circular dependencies of stores**.
- NoÂ *namespaced modules*. Given the flat architecture of stores, "namespacing" stores is inherent to how they are defined and you could say all stores are namespaced.

<br>

<hr>

# Defining a Store
## Option Stores
```javascript
import { defineStore } from â€œpiniaâ€;
export const useProduectStore = defineStore( â€œstore idâ€, {
    state: ()â‡’{
        return {
        
        }
    },
    // âœ… could also be defined as
    // state: () => ({ count: 0 })
    
    // getters
	
    // actions

}
```

<br>

## Setup Stores
Vue Composition API'sÂ setup function ê³¼ ë¹„ìŠ·í•œ ë¬¸ë²•ìœ¼ë¡œ store ë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
```javascript
export const useCounterStore = defineStore('counter', () => {
  const count = ref(0)
  const name = ref('Eduardo')
  const doubleCount = computed(() => count.value * 2)
  function increment() {
    count.value++
  }

  return { count, name, doubleCount, increment }
})
```
InÂ *Setup Stores*:
- `ref()`=Â `state`
- `computed()` =Â `getters`
- `function()` =Â `actions`  

Setup storesëŠ” Option StoresÂ ë³´ë‹¤ ìœ ì—°í•˜ë‹¤. composableë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê³  watchë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ composablesë¥¼ ì‚¬ìš©í•˜ë©´ SSRì—ì„œ ë” ë³µì¡í•´ì§„ë‹¤ëŠ” ê²ƒì„ ì£¼ì˜í•˜ì.

<br>


## What syntax should I pick?
í¸í•´ë³´ì´ëŠ” ê²ƒì„ ì„ íƒí•˜ì. ë§Œì•½ ì˜ ëª¨ë¥´ê² ë‹¤ë©´ Options Storesë¥¼ ë¨¼ì € ì‹œë„í•´ë³´ì.

<br>

## Using the store
storeë¥¼ ìƒì„± ë° ì‘ì„±í–ˆë‹¤ê³  storeë¥¼ ì“¸ ìˆ˜ ìˆëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤. ì‹¤ì œë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” `<script setup>` ì»´í¬ë„ŒíŠ¸ì— ì ìš©ì„ í•´ì£¼ì–´ì•¼ í•œë‹¤.

ìŠ¤í† ì–´ëŠ” reactiveë¡œ ê°ì‹¸ì§„ ê°ì²´ì´ë¯€ë¡œ, gettersì— .valueë¥¼ ì“¸ í•„ìš”ê°€ ì—†ì§€ë§Œ êµ¬ì¡°ë¶„í•´(destructure)ëŠ” ë¶ˆê°€ëŠ¥í•˜ë‹¤. í•˜ì§€ë§Œ `storeToRefs()`ë¥¼ ì‚¬ìš©í•˜ë©´ êµ¬ì¡°ë¶„í•´ë°©ì‹ìœ¼ë¡œ reactivityë¥¼ ìœ ì§€í•œ ì±„ propertiesë¥¼ êº¼ë‚¼ ìˆ˜ ìˆë‹¤. <span style="background-color: #c3930b;color: #000;"> ë‹¤ë§Œ ì´ê²ƒì€ actionsì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì˜¤ì§ stateë§Œ ì‚¬ìš©í•  ë•Œ ìœ ìš©í•˜ë‹¤.</span> ì¶”ê°€ë¡œ actionì€ store ìì²´ì— ë°”ì¸ë”©ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì§ì ‘ storeì—ì„œ actionì„ êµ¬ì¡° ë¶„í•´í•  ìˆ˜ ìˆë‹¤.
<br>

> ë‹¨, storeToRef()ë¥¼ ì´ìš©í•´ êµ¬ì¡° ë¶„í•´í•œ state ê°’ì€ .valueë¥¼ ì‚¬ìš©í•´ì„œ valueê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
> ë§ˆì´ê·¸ë ˆì´ì…˜ì„ í•˜ë©´ì„œ, storeToRef()ëŠ” valueë¥¼ ì‚¬ìš©í•´ì•¼í•˜ëŠ” ì ì´ ë²ˆê±°ë¡œì›Œ êµ¬ì¡° ë¶„í•´ ì—†ì´ ì‚¬ìš©í–ˆë‹¤.

```javascript
<script setup>
import { useCounterStore } from '@/stores/counter'

// access the `store` variable anywhere in the component âœ¨
const store = useCounterStore()

// âŒ state ë¶ˆëŸ¬ì˜¤ê¸° ì ì ˆí•˜ì§€ ì•Šì€ ë°©ë²•-êµ¬ì¡°ë¶„í•´
// This won't work because it breaks reactivity
// it's the same as destructuring from `props`
const { name, doubleCount } = store 
name // will always be "Eduardo" 
doubleCount // will always be 0

// âœ… state ë¶ˆëŸ¬ì˜¤ê¸° ì ì ˆí•œ ë°©ë²•
// this one will be reactive
// ğŸ’¡ but you could also just use `store.doubleCount` directly
const doubleValue = computed(() => store.doubleCount)
ë˜ëŠ”
import { storeToRefs } from 'pinia'
const { name, doubleCount } = storeToRefs(store)

// the increment action can just be destructured
const { increment } = store
</script>
```

> <span style="background-color: #c3930b;color: #000;"> í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´¤ëŠ”ë° ì™œ storeToRef()ê°€ actions ì˜µì…˜ì´ ìˆì„ ë•Œ ë³´ë‹¤ stateë§Œ ìˆì„ ë•Œ ìœ ìš©í•œì§€ ì•Œê² ë‹¤.</span> ë‚˜ëŠ” ë³´í†µ actionsì—ë„ stateì™€ ê°™ì€ ì´ë¦„ìœ¼ë¡œ í•¨ìˆ˜ëª…ì„ ì§“ëŠ”ë° ê·¸ëŸ¬ë©´ ê°™ì€ ì´ë¦„ì´ ì¡´ì¬í•˜ê²Œ ë˜ë©´ì„œ storeToRef()ë¡œ ê²€ìƒ‰ì´ ì•ˆë˜ì–´ undefinedê°€ ëœ° ìˆ˜ ìˆë‹¤.  

> +ì¶”ê°€ë¡œ    
>  vuexì—ì„œëŠ” dispatchí•¨ìˆ˜ ë˜ëŠ” state ê²½ë¡œë¥¼ í†µí•´ actionsì¸ì§€ stateì¸ì§€ êµ¬ë¶„í•  ìˆ˜ ìˆì–´ì„œ actionsì˜ í•¨ìˆ˜ì™€ stateì˜ ê°’ì˜ ì´ë¦„ì„ ê°™ê²Œ í–ˆì§€ë§Œ, í”¼ë‹ˆì•„ì—ì„œ actionsì™€ stateì˜ ì´ë¦„ì„ ê°™ê²Œ ì§€ìœ¼ë©´ í˜¼ë™ì˜ ì—¬ì§€ê°€ ìˆì–´ì„œ ì´ë¦„ì„ ë‹¤ë¥´ê²Œ í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.


```javascript
// stateì™€ actionsì˜ ì´ë¦„ì´ ê°™ì€ ê²½ìš° 
// âŒ ê´„í˜¸ë¥¼ ì´ìš©í•´ êµ¬ë¶„í•˜ê¸° ë•Œë¬¸ì— ì˜ëª» ì“´ ê²½ìš°ì—ë„ íŒŒì•…í•˜ì§€ ëª»í•˜ê³  ì§€ë‚˜ì¹  ê²½ìš°ê°€ ìˆë‹¤.
mainStore.scriptList;
mainStore.scriptList();

// stateì™€ actionsì˜ ì´ë¦„ì´ ë‹¤ë¥¸ ê²½ìš° 
// âœ… êµ¬ë¶„ì´ ìš©ì´í•´ í—·ê°ˆë¦¬ì§€ ì•ŠìŒ
mainStore.scriptList;
mainStore.editScriptList();
```




<br>

## Using a store outside of a component
**main.js ì—ì„œ í”¼ë‹ˆì•„ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•:**  
SSR(Server Side Rendering)ì´ ì•„ë‹ˆë¼ë©´ importí•œ store íŒŒì¼ì„ app.use(pinia) ì„ ì–¸ ì´í›„ì— í˜¸ì¶œí•˜ë©´ ëœë‹¤.
```javascript
import { useUserStore } from '@/stores/user'
import { createPinia } from 'pinia';
import { createApp } from 'vue'
import App from './App.vue'

// âŒ  fails because it's called before the pinia is created
const userStore = useUserStore()

const pinia = createPinia()
const app = createApp(App)
app.use(pinia)

// âœ… works because the pinia instance is now active
const userStore = useUserStore()
```

<br>

## Usage Outside Components
**ì»´í¬ë„ŒíŠ¸ íŒŒì¼ì´ ì•„ë‹Œ ë‹¤ë¥¸ í™•ì¥ì íŒŒì¼ì— store import í•˜ëŠ” ë°©ë²•:**  
íŒŒì¼ì„ import í•œ ë’¤, í•¨ìˆ˜ ì•ˆ ì—ì„œ storeë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
```javascript
// Pinia
import { useAuthUserStore } from '@/stores/auth-user'

router.beforeEach((to, from, next) => {
  // âš ï¸ Must be used within the function! âš ï¸
  const authUserStore = useAuthUserStore()
  if (authUserStore.loggedIn) next()
  else next('/login')
})
```

<br>

# Migrating from Vuex â‰¤4
vuexëŠ” ì—¬ëŸ¬ê°œì˜ modulesê°€ ìˆëŠ” í•˜ë‚˜ì˜ storeì´ë‹¤.

modulesëŠ” namespaced ì¼ ìˆ˜ ìˆê³  ì„œë¡œ nested ë˜ì—ˆì„ ìˆ˜ ë„ ìˆë‹¤.

Piniaë¥¼ ì“°ê¸° ìœ„í•´ ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ ê°ê°ì˜ ëª¨ë“ˆì„ storeë¡œ ë§Œë“œëŠ” ê²ƒì´ë‹¤.
```javascript
# Vuex example (assuming namespaced modules)
src
â””â”€â”€ store
    â”œâ”€â”€ index.js           # Initializes Vuex, imports modules
    â””â”€â”€ modules
        â”œâ”€â”€ module1.js     # 'module1' namespace
        â””â”€â”€ nested
            â”œâ”€â”€ index.js   # 'nested' namespace, imports module2 & module3
            â”œâ”€â”€ module2.js # 'nested/module2' namespace
            â””â”€â”€ module3.js # 'nested/module3' namespace

# Pinia equivalent, note ids match previous namespaces
src
â””â”€â”€ stores
    â”œâ”€â”€ index.js          # (Optional) Initializes Pinia, does not import stores
    â”œâ”€â”€ module1.js        # 'module1' id
    â”œâ”€â”€ nested-module2.js # 'nestedModule2' id
    â”œâ”€â”€ nested-module3.js # 'nestedModule3' id
    â””â”€â”€ nested.js         # 'nested' id
```
- Piniaì—ì„œ namespace ëŠ” id ìƒì„±ê³¼ ë™ì¼í•œ ê¸°ëŠ¥ì„ í•œë‹¤.
- ë””ë ‰í† ë¦¬ ì´ë¦„ì€ ì¼ë°˜ì ìœ¼ë¡œ `stores` ë¼ê³  í•œë‹¤. ì™œëƒí•˜ë©´ í”¼ë‹ˆì•„ëŠ” ì—¬ëŸ¬ê°œì˜ storeë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ê·¸ ì‚¬ì‹¤ì„ ê°•ì¡°í•˜ê¸° ìœ„í•¨ì´ë‹¤.
    
    ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ì—ì„œëŠ” í•œêº¼ë²ˆì— ëª¨ë‘ ë³€í™˜í•˜ëŠ” ê²ƒë³´ë‹¤ ëª¨ë“ˆ ë‹¨ìœ„ë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì´ ì¢‹ì„ ìˆ˜ ìˆë‹¤. ì‹¤ì œë¡œ piniaì™€ vuexë¥¼ ì„ì–´ì„œ ì“¸ ìˆ˜ ìˆê³  migration ì¤‘ì—ëŠ” vuexì™€ pinia ë‘˜ë‹¤ ì ‘ê·¼í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— storesë¼ê³  ëª…ëª… ì´ìœ ë„ ìˆë‹¤.

<br>

## step by step
1. idë¥¼ ì§“ëŠ”ë‹¤. ì´ì „ì˜ namespaceì™€ ë™ì¼í•˜ê¸° ì§“ëŠ”ê±¸ ì¶”ì²œí•œë‹¤. ì™œëƒí•˜ë©´ mapStores() ì‚¬ìš© ì‹œ ìœ ë¦¬í•˜ë‹¤.
2. `state` ë¥¼ functionìœ¼ë¡œ ë³€ê²½í•œë‹¤.
3. getters ë³€ê²½
    1. ê°™ì€ ì´ë¦„ìœ¼ë¡œ ìƒíƒœ(state)ë¥¼ ë°˜í™˜í•˜ëŠ” ê²Œí„°(getters)ë¥¼ ì œê±°í•˜ì„¸ìš” (ì˜ˆ: firstName: (state) => state.firstName). ì´ê²ƒì€ ìŠ¤í† ì–´ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì§ì ‘ ëª¨ë“  ìƒíƒœì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    2. í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ ì“°ë©´ `this` ë¥¼ ì“¸ ìˆ˜ ì—†ìœ¼ë‹ˆ ì¼ë°˜ functionì„ ì‚¬ìš©í•´ë¼.
    3. `rootState` ë˜ëŠ”Â `rootGetters` ë¥¼ ì¸ìë¡œ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹  storeë¥¼ ì§ì ‘ importí•´ë¼.
4. actions ë³€ê²½
    1. `context` ì¸ìë¥¼ ì‚­ì œí•´ë¼. `this` ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.
    2. ë‹¤ë¥¸ store ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ storeíŒŒì¼ì„ ì§ì ‘ import í•´ë¼
5. mutations ë³€ê²½
    1. Piniaì—ëŠ” ë”ì´ìƒ mutationsê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. ëª¨ë‘ actionsì— ë„£ëŠ”ë‹¤. 
    2. ë§Œì•½ actionsì— ë„£ì—ˆë‹¤ë©´ state ì¸ìëŠ” ì‚­ì œí•˜ê³  this ë°”ì¸ë”©ì„ ì´ìš©í•´ì„œ ì ‘ê·¼í•´ë¼
    3. ë¹ŒíŠ¸ì¸ functionì¸ $resetë©”ì„œë“œë¥¼ ì´ìš©í•´ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•  mutations ê°’ì„ ì´ˆê¸°ê°’ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤. ì£¼ì˜í•  ì ìœ¼ë¡  ì´ ê¸°ëŠ¥ì€ option storesì—ë§Œ ì¡´ì¬í•œë‹¤.
