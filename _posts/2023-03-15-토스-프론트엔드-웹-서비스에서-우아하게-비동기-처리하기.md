---
title: 토스 | 프론트엔드 웹 서비스에서 우아하게 비동기 처리하기
date: 2023-03-15
categories: [개발자 컨퍼런스, 토스]
tags: [개발자 컨퍼런스, 토스, 비동기] # TAG names should always be lowercase
pin: true
---

> 클린 코드는 짧은 코드가 아니다. 원하는 로직을 빠르게 찾을 수 있는 코드이다.

***

# 비동기란

요청을 하면 응답이 올 때 까지 기다리고 아무 동작도 할 수 없는 것이 아닌,
응답이 올 때 까지 다른 작업을 하면서 응답이 오면 다시 이어서 할 일을 하는 것이다.

# JS에 Promise가 없던 시절
JS에 Promise가 없었을 때의 코드를 보면 callback함수를 매개변수에 넣어서 callback을 구현한 것을 볼 수 있다.

```javascript
// promise 없을때 코드 예제
```
성공과 실패하는 경우가 같이 있어서 함수의 역할이 가려진다.
또 코드를 작성하는 입장에서 매번 비동기 호출을 할 때 마다 에러 처리를 해줘야해서 불편하다.

<br>

위의 코드를 보고 async-await로 구현된 코드를 보면 async-await의 좋은 점을 알 수 있다.
```javascript
// async-await 코드 예제
```
'성공하는 경우'만 다루고 '실패하는 경우'는 catch절에서 분리해서 처리한다.
덕분에 함수의 역할이 잘 드러난다.

<br>

이를 통해 좋은 코드의 특징을 정리할 수 있다.

<br>

| 좋은 코드 특징 |
| :---: |
| 성공/실패하는 경우를 분리해서 처리 가능 |
| 비즈니스 로직을 한눈에 파악이 가능 |

<br>

# 비동기 코드가 2개 이상일 때

예를 들어 2개의 비동기 리소스가 있다고 할 때 리소스를 가져올 떄의 상태를 나타낸 표가 있다.

|  | 로딩 | 에러 | 완료 |
| :---: | :---: | :---: | :---: |
| 로딩 |  |  |  |
| 에러 |  |  |  |
| 완료 |  |  |  |

비동기는 '로딩', '에러', '완료' 총 3가지 상태가 존재한다.  
그래서 비동기 리소스가 2개만 있다고 해도 상태의 경우의 수는 총 9개의 상태가 된다.

그런데 이러한 비동기 호출이 3, 4개면 더 복잡해질 것이다.

<br>

# React의 비동기 처리는 어렵다.

React의 Hook이나 State를 사용하는 방식으로는 async-await와 같은 간단한 비동기 구현이 어렵다.

하지만 리액트 팀이 제안하는 "React Suspense for Data Fetching"이 있다.  
말 그래도 "데이터를 가져오기 위한 Suspense" 이다. 취지는 async-await처럼 비동기 처리가 가능한 React 컴포넌트 구현이다.

***
